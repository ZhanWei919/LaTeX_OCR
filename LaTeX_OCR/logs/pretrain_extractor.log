2025-04-28 19:13:30,554 - INFO - ô D:\LaTeX_OCR\configs\pretrain_config.yaml ء
2025-04-28 19:13:30,555 - INFO - 浽: ../checkpoints/feature_extractor
2025-04-28 19:13:30,555 - INFO - ־¼: ../logs/pretrain_extractor.log
2025-04-28 19:13:30,612 - INFO - Ϊ: 42
2025-04-28 19:13:30,613 - INFO - ʹ豸: cpu
2025-04-28 19:13:30,645 - INFO - ʻ: 466 tokens. PAD ID: 0
2025-04-28 19:13:30,645 - INFO - ݼ...
2025-04-28 19:13:30,909 - ERROR - ݼʧ: Error loading formula data from ../data/im2latex_formulas.norm.csv or ../data/im2latex_train.csv: 'formula'
2025-04-28 19:18:51,187 - INFO - ô D:\LaTeX_OCR\configs\pretrain_config.yaml ء
2025-04-28 19:18:51,187 - INFO - 浽: ../checkpoints/feature_extractor
2025-04-28 19:18:51,187 - INFO - ־¼: ../logs/pretrain_extractor.log
2025-04-28 19:18:51,203 - INFO - Ϊ: 42
2025-04-28 19:18:51,204 - INFO - ʹ豸: cpu
2025-04-28 19:18:51,204 - INFO - ʻ: 466 tokens. PAD ID: 0
2025-04-28 19:18:51,204 - INFO - ݼ...
2025-04-28 19:18:51,301 - ERROR - ݼʧ: Error loading formula data from ../data/im2latex_formulas.norm.csv or ../data/im2latex_train.csv: 'formula'
2025-04-28 19:19:49,939 - INFO - ô D:\LaTeX_OCR\configs\pretrain_config.yaml ء
2025-04-28 19:19:49,939 - INFO - 浽: ../checkpoints/feature_extractor
2025-04-28 19:19:49,939 - INFO - ־¼: ../logs/pretrain_extractor.log
2025-04-28 19:19:49,959 - INFO - Ϊ: 42
2025-04-28 19:19:49,959 - INFO - ʹ豸: cpu
2025-04-28 19:19:49,959 - INFO - ʻ: 466 tokens. PAD ID: 0
2025-04-28 19:19:49,959 - INFO - ݼ...
2025-04-28 19:19:50,060 - ERROR - ݼʧ: Error loading formula data from ../data/im2latex_formulas.norm.csv or ../data/im2latex_train.csv: 'formula'
2025-04-28 19:23:30,210 - INFO - ô D:\LaTeX_OCR\configs\pretrain_config.yaml ء
2025-04-28 19:23:30,210 - INFO - 浽: ../checkpoints/feature_extractor
2025-04-28 19:23:30,210 - INFO - ־¼: ../logs/pretrain_extractor.log
2025-04-28 19:23:30,230 - INFO - Ϊ: 42
2025-04-28 19:23:30,230 - INFO - ʹ豸: cpu
2025-04-28 19:23:30,230 - INFO - ʻ: 466 tokens. PAD ID: 0
2025-04-28 19:23:30,230 - INFO - ݼ...
2025-04-28 19:23:30,231 - ERROR - ݼʧ: Error loading formula data from data/im2latex_formulas.norm.csv or data/im2latex_train.csv: [Errno 2] No such file or directory: 'data/im2latex_train.csv'
2025-04-28 19:23:49,671 - INFO - ô D:\LaTeX_OCR\configs\pretrain_config.yaml ء
2025-04-28 19:23:49,671 - INFO - 浽: ../checkpoints/feature_extractor
2025-04-28 19:23:49,671 - INFO - ־¼: ../logs/pretrain_extractor.log
2025-04-28 19:23:49,689 - INFO - Ϊ: 42
2025-04-28 19:23:49,689 - INFO - ʹ豸: cpu
2025-04-28 19:23:49,689 - INFO - ʻ: 466 tokens. PAD ID: 0
2025-04-28 19:23:49,689 - INFO - ݼ...
2025-04-28 19:23:49,789 - ERROR - ݼʧ: Error loading formula data from ../data/im2latex_formulas.norm.csv or ../data/im2latex_train.csv: 'formula'
2025-04-28 19:43:14,197 - INFO - ô D:\LaTeX_OCR\configs\pretrain_config.yaml ء
2025-04-28 19:43:14,197 - INFO - 浽: ../checkpoints/feature_extractor
2025-04-28 19:43:14,197 - INFO - ־¼: ../logs/pretrain_extractor.log
2025-04-28 19:43:14,215 - INFO - Ϊ: 42
2025-04-28 19:43:14,216 - INFO - ʹ豸: cpu
2025-04-28 19:43:14,216 - INFO - ʻ: 466 tokens. PAD ID: 0
2025-04-28 19:43:14,216 - INFO - ݼ...
2025-04-28 19:43:14,216 - ERROR - ݼʧ: 'train_json_file'
2025-04-28 19:48:26,934 - INFO - 配置从 ../configs/pretrain_config.yaml 加载。
2025-04-28 19:48:26,934 - INFO - 输出将保存到: D:\LaTeX_OCR\checkpoints/feature_extractor
2025-04-28 19:48:26,934 - INFO - 日志将记录到: D:\LaTeX_OCR\logs/pretrain_extractor.log
2025-04-28 19:48:26,951 - INFO - 随机种子设置为: 42
2025-04-28 19:48:26,951 - INFO - 使用设备: cpu
2025-04-28 19:48:26,951 - INFO - 词汇表加载: 466 tokens. PAD ID: 0
2025-04-28 19:48:26,951 - INFO - 创建数据加载器...
2025-04-28 19:48:26,951 - INFO - 将从 JSON 文件加载数据: D:/LaTeX_OCR/data/train.json
2025-04-28 19:48:27,320 - INFO - 数据加载器创建完成，共 75262 样本。
2025-04-28 19:48:27,320 - INFO - 初始化模型...
2025-04-28 19:48:27,909 - INFO - 模型初始化完成，总参数量: 86,363,137
2025-04-28 20:04:06,358 - INFO - 配置从 ../configs/pretrain_config.yaml 加载。
2025-04-28 20:04:06,358 - INFO - 输出将保存到: D:\LaTeX_OCR\checkpoints/feature_extractor
2025-04-28 20:04:06,358 - INFO - 日志将记录到: D:\LaTeX_OCR\logs/pretrain_extractor.log
2025-04-28 20:04:06,375 - INFO - 随机种子设置为: 42
2025-04-28 20:04:06,375 - INFO - 使用设备: cpu
2025-04-28 20:04:06,375 - INFO - 词汇表加载: 466 tokens. PAD ID: 0
2025-04-28 20:04:06,375 - INFO - 创建数据加载器...
2025-04-28 20:04:06,375 - INFO - 将从 JSON 文件加载数据: D:/LaTeX_OCR/data/train.json
2025-04-28 20:04:06,551 - INFO - 数据加载器创建完成，共 75262 样本。
2025-04-28 20:04:06,551 - INFO - 初始化模型...
2025-04-28 20:04:06,953 - INFO - 模型初始化完成，总参数量: 86,363,137
2025-04-28 22:46:43,872 - INFO - 配置从 ../configs/pretrain_config.yaml 加载。
2025-04-28 22:46:43,874 - INFO - 输出将保存到: D:\LaTeX_OCR\checkpoints/feature_extractor
2025-04-28 22:46:43,874 - INFO - 日志将记录到: D:\LaTeX_OCR\logs/pretrain_extractor.log
2025-04-28 22:46:43,904 - INFO - 随机种子设置为: 42
2025-04-28 22:46:43,905 - INFO - 使用设备: cpu
2025-04-28 22:46:43,918 - INFO - 词汇表加载: 466 tokens. PAD ID: 0
2025-04-28 22:46:43,918 - INFO - 创建数据加载器...
2025-04-28 22:46:43,918 - INFO - 将从 JSON 文件加载数据: D:/LaTeX_OCR/data/train.json
2025-04-28 22:46:44,308 - INFO - 数据加载器创建完成，共 75262 样本。
2025-04-28 22:46:44,308 - INFO - 初始化模型...
2025-04-28 22:46:44,895 - INFO - 模型初始化完成，总参数量: 86,363,137
2025-04-28 22:47:37,411 - INFO - 配置从 ../configs/pretrain_config.yaml 加载。
2025-04-28 22:47:37,411 - INFO - 输出将保存到: D:\LaTeX_OCR\checkpoints/feature_extractor
2025-04-28 22:47:37,411 - INFO - 日志将记录到: D:\LaTeX_OCR\logs/pretrain_extractor.log
2025-04-28 22:47:37,427 - INFO - 随机种子设置为: 42
2025-04-28 22:47:37,427 - INFO - 使用设备: cpu
2025-04-28 22:47:37,428 - INFO - 词汇表加载: 466 tokens. PAD ID: 0
2025-04-28 22:47:37,428 - INFO - 创建数据加载器...
2025-04-28 22:47:37,428 - INFO - 将从 JSON 文件加载数据: D:/LaTeX_OCR/data/train.json
2025-04-28 22:47:37,598 - INFO - 数据加载器创建完成，共 75262 样本。
2025-04-28 22:47:37,598 - INFO - 初始化模型...
2025-04-28 22:47:37,973 - INFO - 模型初始化完成，总参数量: 86,363,137
2025-04-28 22:47:37,973 - INFO - 优化器: AdamW (lr=5e-5, weight_decay=0.01)
2025-04-28 22:47:37,973 - INFO - 调度器: CosineAnnealingLR (T_max=10760, eta_min=1e-7) with Linear Warmup (1000 steps)
2025-04-28 22:47:37,974 - INFO - 损失权重: MLM=1.0, Structure=0.5
2025-04-28 22:47:37,975 - INFO - 使用混合精度 (AMP): True
2025-04-28 22:47:37,975 - INFO - 开始预训练循环...
2025-04-28 22:47:37,975 - INFO - 总训练轮数: 10
2025-04-28 22:47:37,975 - INFO - 每轮步数 (更新次数): 1176
2025-04-28 22:47:37,975 - INFO - 总训练步数: 11760
2025-04-29 19:01:13,177 - INFO - 配置从 D:\LaTeX_OCR\configs\pretrain_config.yaml 加载
2025-04-29 19:01:13,177 - INFO - 输出将保存到: D:\LaTeX_OCR\checkpoints\feature_extractor
2025-04-29 19:01:13,178 - INFO - 日志将记录到: D:\LaTeX_OCR\logs\pretrain_extractor.log
2025-04-29 19:01:13,312 - INFO - CUDA 不可用，仅设置 CPU 随机种子
2025-04-29 19:01:13,312 - INFO - 全局随机种子设置为: 42
2025-04-29 19:01:13,313 - INFO - 未检测到 CUDA 设备，将使用 CPU
2025-04-29 19:01:13,319 - INFO - 使用设备: cpu
2025-04-29 19:01:13,350 - INFO - 词汇表加载: 466 tokens. PAD ID: 0
2025-04-29 19:01:13,350 - INFO - 创建数据加载器...
2025-04-29 19:01:13,350 - INFO - 初始化模型...
2025-04-29 19:01:14,936 - INFO - 模型初始化完成，总参数量: 86,363,137
2025-04-29 19:01:19,669 - INFO - 优化器: AdamW (lr=5e-05, weight_decay=0.01)
2025-04-29 19:08:37,419 - INFO - 配置从 D:\LaTeX_OCR\configs\pretrain_config.yaml 加载
2025-04-29 19:08:37,419 - INFO - 输出将保存到: D:\LaTeX_OCR\checkpoints\feature_extractor
2025-04-29 19:08:37,419 - INFO - 日志将记录到: D:\LaTeX_OCR\logs\pretrain_extractor.log
2025-04-29 19:08:37,420 - INFO - CUDA 不可用，仅设置 CPU 随机种子
2025-04-29 19:08:37,420 - INFO - 全局随机种子设置为: 42
2025-04-29 19:08:37,420 - INFO - 未检测到 CUDA 设备，将使用 CPU
2025-04-29 19:08:37,420 - INFO - 使用设备: cpu
2025-04-29 19:08:37,421 - INFO - 词汇表加载: 466 tokens. PAD ID: 0
2025-04-29 19:08:37,421 - INFO - 创建数据加载器...
2025-04-29 19:08:37,421 - INFO - 初始化模型...
2025-04-29 19:08:37,838 - INFO - 模型初始化完成，总参数量: 86,363,137
2025-04-29 19:08:38,956 - INFO - 优化器: AdamW (lr=5e-05, weight_decay=0.01)
2025-04-29 19:09:44,482 - INFO - 配置从 D:\LaTeX_OCR\configs\pretrain_config.yaml 加载。
2025-04-29 19:09:44,482 - INFO - 输出将保存到: D:\LaTeX_OCR\checkpoints\feature_extractor
2025-04-29 19:09:44,482 - INFO - 日志将记录到: D:\LaTeX_OCR\logs\pretrain_extractor.log
2025-04-29 19:09:44,483 - INFO - CUDA 不可用，仅设置 CPU 随机种子。
2025-04-29 19:09:44,483 - INFO - 全局随机种子设置为: 42
2025-04-29 19:09:44,483 - INFO - 未检测到 CUDA 设备，将使用 CPU。
2025-04-29 19:09:44,483 - INFO - 使用设备: cpu
2025-04-29 19:09:44,484 - INFO - 词汇表加载: 466 tokens. PAD ID: 0
2025-04-29 19:09:44,484 - INFO - 创建数据加载器...
2025-04-29 19:09:44,484 - INFO - 将从 JSON 文件加载数据: D:/LaTeX_OCR/data/train.json
2025-04-29 19:09:44,928 - INFO - 数据加载器创建完成，共 75262 样本。
2025-04-29 19:09:44,929 - WARNING - 在 CPU 模式下，建议将 num_workers 设置为 0 以避免潜在问题。当前 num_workers > 0。
2025-04-29 19:09:44,929 - INFO - 初始化模型...
2025-04-29 19:09:45,325 - INFO - 模型初始化完成，总参数量: 86,363,137
2025-04-29 19:09:46,354 - INFO - 优化器: AdamW (lr=5e-05, weight_decay=0.01)
2025-04-29 19:09:46,354 - INFO - 调度器: CosineAnnealingLR (T_max=10760, eta_min=1e-07) with Linear Warmup (1000 steps)
2025-04-29 19:09:46,355 - INFO - 损失权重: MLM=1.0, Structure=0.5
2025-04-29 19:09:46,355 - INFO - 配置请求使用混合精度 (AMP): True
2025-04-29 19:09:46,355 - INFO - CPU AMP 已启用 (实验性), 使用 dtype: torch.bfloat16, GradScaler: 已禁用
2025-04-29 19:09:46,355 - INFO - ========================================
2025-04-29 19:09:46,355 - INFO - 开始预训练循环...
2025-04-29 19:09:46,355 - INFO - 总训练轮数: 10
2025-04-29 19:09:46,355 - INFO - 每轮步数 (数据加载次数): 1176
2025-04-29 19:09:46,355 - INFO - 梯度累积步数: 1
2025-04-29 19:09:46,355 - INFO - 每轮更新次数 (优化器步数): 1176
2025-04-29 19:09:46,355 - INFO - 总训练步数 (优化器步数): 11760
2025-04-29 19:09:46,355 - INFO - ========================================
2025-04-29 19:18:37,115 - INFO - 配置从 D:\LaTeX_OCR\configs\pretrain_config.yaml 加载。
2025-04-29 19:18:37,115 - INFO - 输出将保存到: D:\LaTeX_OCR\checkpoints\feature_extractor
2025-04-29 19:18:37,115 - INFO - 日志将记录到: D:\LaTeX_OCR\logs\pretrain_extractor.log
2025-04-29 19:18:37,160 - INFO - CUDA 不可用，仅设置 CPU 随机种子。
2025-04-29 19:18:37,160 - INFO - 全局随机种子设置为: 42
2025-04-29 19:18:37,160 - INFO - 未检测到 CUDA 设备，将使用 CPU。
2025-04-29 19:18:37,160 - INFO - 使用设备: cpu
2025-04-29 19:18:37,161 - INFO - 词汇表加载: 466 tokens. PAD ID: 0
2025-04-29 19:18:37,161 - INFO - 创建数据加载器...
2025-04-29 19:18:37,161 - INFO - 将从 JSON 文件加载数据: D:/LaTeX_OCR/data/train.json
2025-04-29 19:18:37,543 - INFO - 数据加载器创建完成，共 75262 样本。
2025-04-29 19:18:37,543 - WARNING - 在 CPU 模式下，建议将 num_workers 设置为 0 以避免潜在问题。当前 num_workers > 0。
2025-04-29 19:18:37,543 - INFO - 初始化模型...
2025-04-29 19:18:37,940 - INFO - 模型初始化完成，总参数量: 86,363,137
2025-04-29 19:18:42,331 - INFO - 优化器: AdamW (lr=5e-05, weight_decay=0.01)
2025-04-29 19:18:42,331 - INFO - 调度器: CosineAnnealingLR (T_max=10760, eta_min=1e-07) with Linear Warmup (1000 steps)
2025-04-29 19:18:42,331 - INFO - 损失权重: MLM=1.0, Structure=0.5
2025-04-29 19:18:42,331 - INFO - 配置请求使用混合精度 (AMP): True
2025-04-29 19:18:42,331 - INFO - CPU AMP 已启用 (实验性), 使用 dtype: torch.bfloat16, GradScaler: 已禁用
2025-04-29 19:18:42,331 - INFO - ========================================
2025-04-29 19:18:42,331 - INFO - 开始预训练循环...
2025-04-29 19:18:42,331 - INFO - 总训练轮数: 10
2025-04-29 19:18:42,331 - INFO - 每轮步数 (数据加载次数): 1176
2025-04-29 19:18:42,331 - INFO - 梯度累积步数: 1
2025-04-29 19:18:42,331 - INFO - 每轮更新次数 (优化器步数): 1176
2025-04-29 19:18:42,331 - INFO - 总训练步数 (优化器步数): 11760
2025-04-29 19:18:42,331 - INFO - ========================================
